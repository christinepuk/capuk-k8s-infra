# LKE-optimized configuration for christinepuk.net
global:
  storageClass: "linode-block-storage-retain"
  domain: "christinepuk.net"
  timezone: "UTC"

# AudioBookShelf configuration
audiobookshelf:
  enabled: true
  persistence:
    config:
      size: 20Gi
      storageClass: "linode-block-storage-retain"
    audiobooks:
      size: 200Gi
      storageClass: "linode-block-storage-retain"
    metadata:
      size: 20Gi
      storageClass: "linode-block-storage-retain"
  resources:
    requests:
      memory: 256Mi
      cpu: 200m
    limits:
      memory: 512Mi
      cpu: 500m
  ingress:
    host: "books.christinepuk.net"

# Plex configuration
plex:
  enabled: true
  claimToken: "${PLEX_CLAIM_TOKEN}"
  
  # Enable rclone for object storage
  rclone:
    enabled: true
    remoteName: "linode"
    remotePath: "capuk-media"                # Bucket name
    type: "s3"
    
    # rclone configuration for linode object storage
    config:
      type: "s3"
      provider: "Other"
      env_auth: false
      access_key_id: "${ACCESS_KEY}"
      secret_access_key: "${SECRET_KEY}"
      region: "us-iad-1"
      endpoint: "us-iad-1.linodeobjects.com"
    
    # Optimized VFS settings for media streaming
    vfsCacheMode: "writes"
    vfsCacheMaxSize: "2G"                    # Increase for better performance
    vfsCacheMaxAge: "24h"                    # Cache files longer for media
    bufferSize: "128M"                       # Large buffer for streaming
    dirCacheTime: "15m"                      # Cache directory listings
    timeout: "10m"                           # Longer timeout for large files
    contimeout: "60s"
    
    extraArgs:
      - "--transfers=4"                      # Parallel transfers
      - "--checkers=8"                       # Parallel file checks
      - "--use-mmap"                         # Memory mapping for performance
  
  persistence:
    config:
      size: 50Gi
      storageClass: "linode-block-storage-retain"
    media:
      enabled: false                         # Disable local media storage when using rclone
  resources:
    requests:
      memory: 1Gi                            # Reasonable for cluster capacity
      cpu: 300m                              # Fits within node capacity
    limits:
      memory: 2Gi                            # Still plenty for Plex
      cpu: 800m                              # Max we can get on 1-core nodes
  ingress:
    host: "tv.christinepuk.net"

# WordPress sites
wordpress:
  sites:
    site1:
      enabled: true
      name: "blog"
      host: "blog.christinepuk.net"
    site2:
      enabled: true
      name: "djpup"
      host: "djpup.christinepuk.net"
    site3:
      enabled: true
      name: "surf"
      host: "surf.christinepuk.net"
    site4:
      enabled: true
      name: "dizzy"
      host: "thedizzyengineer.com"
  
  persistence:
    size: 20Gi
    storageClass: "linode-block-storage-retain"
  
  mysql:
    persistence:
      size: 50Gi
      storageClass: "linode-block-storage-retain"
    auth:
      rootPassword: "${MYSQL_ROOT_PASSWORD}"
      database: "wordpress"
      username: "wordpress"
      password: "${MYSQL_PASSWORD}"
      password: "${MYSQL_PASSWORD}"